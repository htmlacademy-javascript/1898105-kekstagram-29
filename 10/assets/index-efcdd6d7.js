(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}})();const i=(e,t)=>Math.floor(Math.random()*(t-e+1))+e;function b(e,t){return e.length<=t}b("проверяемая строка",20);function M(e){const t=e.replaceAll(" ","").toLowerCase();let c="";for(let r=t.length-1;r>=0;r--)c+=t.at([r]);return t===c}M("Лёша на полке клопа нашёл ");function N(e){const t=e.toString();let c="";for(let r=0;r<t.length;r++)Number.isNaN(parseInt(t[r],10))||(c+=t[r]);return parseInt(c,10)}N("ECMAScript 2022");const d=e=>e.key==="Escape",k=5,w=/^#[a-zа-яё0-9]{1,19}$/i,I=document.querySelector("body"),A=document.querySelector(".img-upload__input "),p=document.querySelector(".img-upload__overlay"),x=document.querySelector(".img-upload__cancel"),u=document.querySelector(".img-upload__form"),m=u.querySelector(".text__hashtags"),T=document.querySelector(".text__description"),l=new Pristine(u,{classTo:"img-upload__field-wrapper",errorTextParent:"img-upload__field-wrapper"}),g=e=>e.trim().split(" ").filter(t=>!!t.length),D=e=>g(e).every(t=>w.test(t)),O=e=>g(e).length<=k,B=e=>{const t=g(e).map(c=>c.toLowerCase());return t.length===new Set(t).size};l.addValidator(m,O,"Много хештегов",3,!0);l.addValidator(m,B,"Не уникальный хештег",1,!0);l.addValidator(m,D,"Не правильный хештег",2,!0);u.addEventListener("submit",e=>{e.preventDefault(),l.validate()});const y=e=>{d(e)&&(e.preventDefault(),p.classList.add("hidden"),document.body.classList.remove("modal-open"))},H=()=>{p.classList.remove("hidden"),I.classList.add("modal-open"),document.addEventListener("keydown",y)},F=()=>{p.classList.add("hidden"),document.body.classList.remove("modal-open"),u.reset(),l.reset(),document.removeEventListener("keydown",y)},X=e=>{d(e)&&e.stopPropagation()},$=e=>{d(e)&&e.stopPropagation()};A.addEventListener("change",H);x.addEventListener("click",F);document.addEventListener("keydown",y);T.addEventListener("keydown",X);m.addEventListener("keydown",$);const K=25,U=125,f=["Всё отлично!","В целом всё неплохо. Но не всё.","Когда вы делаете фотографию, хорошо бы убирать палец из кадра. В конце концов это просто непрофессионально.","Моя бабушка случайно чихнула с фотоаппаратом в руках и у неё получилась фотография лучше.","Я поскользнулся на банановой кожуре и уронил фотоаппарат на кота и у меня получилась фотография лучше.","Лица у людей на фотке перекошены, как будто их избивают. Как можно было поймать такой неудачный момент?!"],_={MIN:15,MAX:200},C={MIN:1,MAX:1e6},L={MIN:1,MAX:6},S=["Иван","Андрей","Мария","Николай","Елена","Ольга","Фигаро"],v=["Описание 1","Описание 2","Описание 3","Описание 4","Описание 5"],V=()=>{const e=[];for(let t=1;t<i(0,U);t++)e.push({id:i(C.MIN,C.MAX),avatar:`img/avatar-${i(L.MIN,L.MAX)}.svg`,message:f[i(0,f.length-1)],name:S[i(0,S.length-1)]});return e},z=e=>({id:e,url:`photos/${e}.jpg`,description:v[i(0,v.length-1)],likes:i(_.MIN,_.MAX),comments:V()}),G=()=>{const e=[];for(let t=1;t<=K;t++)e.push(z(t));return e},j=document.querySelector(".social__comments"),R=document.querySelector("#comment").content.querySelector(".social__comment"),q=e=>{const t=document.createDocumentFragment();e.forEach(c=>{const r=R.cloneNode(!0),o=r.querySelector(".social__picture");o.src=c.avatar,o.alt=c.name,r.querySelector(".social__text").textContent=c.message,t.append(r)}),j.append(t)},h=document.querySelector(".big-picture"),J=document.querySelector(".big-picture__img"),Q=J.querySelector("img"),W=document.querySelector(".social__caption"),Y=document.querySelector(".likes-count"),Z=document.querySelector(".big-picture__cancel"),ee=document.querySelector(".comments-count"),a=document.querySelector(".comments-loader"),E=document.querySelector(".social__comment-count"),te=()=>{h.classList.add("hidden"),document.querySelector(".social__comments").textContent="",document.body.classList.remove("modal-open")},oe=e=>{d(e)&&(e.preventDefault(),h.classList.add("hidden"),document.querySelector(".social__comments").textContent="",document.body.classList.remove("modal-open"))},ne=e=>{a.classList.remove("hidden");let t=5;const{url:c,likes:r,comments:o,description:n}=e;o.length<=t&&(t=o.length,a.classList.add("hidden")),E.textContent=`${t} из ${o.length} комментариев`,h.classList.remove("hidden"),document.body.classList.add("modal-open"),Q.src=c,W.textContent=n,Y.textContent=r,ee.textContent=o.length,q(o.slice(0,t));const s=()=>{a.classList.remove("hidden"),document.querySelector(".social__comments").textContent="",t=t+5,t>=o.length&&(t=o.length,a.classList.add("hidden")),q(o.slice(0,t)),E.textContent=`${t} из ${o.length} комментариев`};a.addEventListener("click",s),Z.addEventListener("click",te),document.addEventListener("keydown",oe)},ce=document.querySelector(".pictures"),re=document.querySelector("#picture").content,se=re.querySelector("a"),ie=e=>{const{url:t,likes:c,comments:r,description:o}=e,n=se.cloneNode(!0);n.querySelector(".picture__img").src=t,n.querySelector(".picture__img").alt=o,n.querySelector(".picture__comments").textContent=r.length,n.querySelector(".picture__likes").textContent=c;const s=P=>{P.preventDefault(),ne(e)};return n.addEventListener("click",s),n},ae=e=>{const t=document.createDocumentFragment();e.forEach(c=>{t.append(ie(c))}),ce.append(t)};ae(G());
